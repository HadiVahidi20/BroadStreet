<!--
  Broadstreet Sponsors (Google Sheets) - GoHighLevel Custom HTML Snippet

  How to use:
  1) Paste this entire block into a GHL "Custom HTML" element.
  2) Set the CONFIG values below.
-->

<style>
  .bs-sponsors { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; max-width: 900px; margin: 0 auto; }
  .bs-sponsors h2 { margin: 0 0 8px; font-size: 24px; text-align: center; }
  .bs-sponsors-sub { text-align: center; opacity: 0.7; margin-bottom: 24px; }
  .bs-sponsor-tier { margin-bottom: 24px; }
  .bs-sponsor-tier-label { font-size: 13px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; opacity: 0.6; margin-bottom: 12px; text-align: center; }
  .bs-sponsor-main { display: flex; justify-content: center; }
  .bs-sponsor-card { display: flex; flex-direction: column; align-items: center; border: 1px solid rgba(0,0,0,0.1); border-radius: 12px; padding: 20px; background: #fff; text-decoration: none; color: inherit; transition: box-shadow 0.2s; }
  .bs-sponsor-card:hover { box-shadow: 0 4px 16px rgba(0,0,0,0.1); }
  .bs-sponsor-card img { max-height: 80px; max-width: 180px; object-fit: contain; margin-bottom: 10px; }
  .bs-sponsor-name { font-weight: 600; font-size: 15px; }
  .bs-sponsor-tagline { font-size: 12px; opacity: 0.6; margin-top: 2px; }
  .bs-sponsor-grid { display: grid; gap: 14px; }
  .bs-sponsor-grid--premium { grid-template-columns: repeat(3, 1fr); }
  .bs-sponsor-grid--partner { grid-template-columns: repeat(4, 1fr); }
  .bs-sponsor-grid--partner .bs-sponsor-card img { max-height: 60px; }
  .bs-sponsor-badge { font-size: 10px; font-weight: 700; text-transform: uppercase; padding: 2px 8px; border-radius: 4px; margin-bottom: 8px; }
  .bs-badge-platinum { background: #e8eaf6; color: #283593; }
  .bs-badge-gold { background: #fff8e1; color: #f57f17; }
  .bs-badge-silver { background: #f5f5f5; color: #616161; }
  @media (max-width: 768px) {
    .bs-sponsor-grid--premium { grid-template-columns: repeat(2, 1fr); }
    .bs-sponsor-grid--partner { grid-template-columns: repeat(3, 1fr); }
  }
  @media (max-width: 480px) {
    .bs-sponsor-grid--premium { grid-template-columns: 1fr; }
    .bs-sponsor-grid--partner { grid-template-columns: repeat(2, 1fr); }
  }
</style>

<section class="bs-sponsors" data-bs-sponsors>
  <h2>Our Sponsors</h2>
  <p class="bs-sponsors-sub">Proud to be supported by our partners</p>
  <div data-bs-sponsors-title class="bs-sponsor-tier"></div>
  <div data-bs-sponsors-premium class="bs-sponsor-tier"></div>
  <div data-bs-sponsors-partner class="bs-sponsor-tier"></div>
</section>

<script>
(function () {
  var CONFIG = {
    apiKey: "AIzaSyDeLiOcwEJuu8sCt6UjN74-Q9pvNljeoq4",
    sheetId: "1DT5Xti6N6uc9XgXJENQuF7B29uCAVwEQYQX3F6WRVc0",
    range: "sponsors!A1:Z",
  };

  function esc(s) { return String(s||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"); }
  function normalizeHeader(h) { return String(h||"").trim().toLowerCase().replace(/\s+/g,"_"); }

  function rowsToObjects(values) {
    if (!Array.isArray(values)||values.length<2) return [];
    var headers=values[0].map(normalizeHeader), out=[];
    for (var i=1;i<values.length;i++) {
      var row=values[i]; if(!row||row.every(function(c){return String(c||"").trim()==="";})) continue;
      var obj={}; for(var c=0;c<headers.length;c++){if(!headers[c]) continue; obj[headers[c]]=row[c]!=null?row[c]:"";} out.push(obj);
    }
    return out;
  }

  function card(s, badgeClass, badgeText) {
    return '<a href="'+esc(s.link||"#")+'" class="bs-sponsor-card" target="_blank" rel="noopener">' +
      '<span class="bs-sponsor-badge '+badgeClass+'">'+badgeText+'</span>' +
      (s.logo ? '<img src="'+esc(s.logo)+'" alt="'+esc(s.name)+'">' : '') +
      '<span class="bs-sponsor-name">'+esc(s.name)+'</span>' +
      (s.tagline ? '<span class="bs-sponsor-tagline">'+esc(s.tagline)+'</span>' : '') +
      '</a>';
  }

  async function init() {
    var root = document.querySelector("[data-bs-sponsors]");
    if (!root) return;
    try {
      var url = "https://sheets.googleapis.com/v4/spreadsheets/"+encodeURIComponent(CONFIG.sheetId)+"/values/"+encodeURIComponent(CONFIG.range)+"?key="+encodeURIComponent(CONFIG.apiKey)+"&majorDimension=ROWS";
      var resp = await fetch(url, {headers:{accept:"application/json"}});
      if (!resp.ok) throw new Error(resp.status);
      var sponsors = rowsToObjects((await resp.json()).values);
      if (!sponsors.length) return;

      var title = sponsors.filter(function(s){return(s.tier||"").toLowerCase()==="title";});
      var premium = sponsors.filter(function(s){return(s.tier||"").toLowerCase()==="premium";});
      var partner = sponsors.filter(function(s){return(s.tier||"").toLowerCase()==="partner";});

      var titleEl = root.querySelector("[data-bs-sponsors-title]");
      var premEl = root.querySelector("[data-bs-sponsors-premium]");
      var partEl = root.querySelector("[data-bs-sponsors-partner]");

      if (titleEl && title.length) {
        titleEl.innerHTML = '<div class="bs-sponsor-tier-label">Title Sponsor</div><div class="bs-sponsor-main">' + title.map(function(s){return card(s,"bs-badge-platinum","Platinum");}).join("") + '</div>';
      }
      if (premEl && premium.length) {
        premEl.innerHTML = '<div class="bs-sponsor-tier-label">Premium Sponsors</div><div class="bs-sponsor-grid bs-sponsor-grid--premium">' + premium.map(function(s){return card(s,"bs-badge-gold","Gold");}).join("") + '</div>';
      }
      if (partEl && partner.length) {
        partEl.innerHTML = '<div class="bs-sponsor-tier-label">Official Partners</div><div class="bs-sponsor-grid bs-sponsor-grid--partner">' + partner.map(function(s){return card(s,"bs-badge-silver","Silver");}).join("") + '</div>';
      }
    } catch(e) { try{console.error(e);}catch(x){} }
  }

  if (document.readyState==="loading") document.addEventListener("DOMContentLoaded",init); else init();
})();
</script>
