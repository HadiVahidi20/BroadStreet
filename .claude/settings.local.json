{
  "permissions": {
    "allow": [
      "WebFetch(domain:rctoulon.com)",
      "WebFetch(domain:www.broadstreet-rugby.co.uk)",
      "WebFetch(domain:unsplash.com)",
      "WebFetch(domain:www.pexels.com)",
      "WebFetch(domain:dancelife31.ru)",
      "Bash(grep:*)",
      "Bash(bash:*)",
      "Bash(test:*)",
      "Bash(if ! grep -q \"site-config.js\" index.html)",
      "Bash(then sed -i 's|</body>|  <script src=\"\"js/site-config.js\"\"></script>\\\\n</body>|' index.html)",
      "Bash(else echo \"âœ… site-config.js already in index.html\")",
      "Bash(fi)",
      "Bash(for file in pages/*.html)",
      "Bash(do if [ -f \"$file\" ])",
      "Bash(! grep -q \"top-bar-social\" \"$file\")",
      "Bash(then echo \"Processing: $file\")",
      "Bash(done)",
      "Bash(then basename \"$file\")",
      "Bash(python add-social-media.py:*)",
      "Bash(python3:*)",
      "Bash(for file in index.html pages/*.html)",
      "Bash(then echo \"$file\")",
      "Bash(ls:*)",
      "Bash(wc:*)",
      "Bash(dir:*)",
      "WebFetch(domain:www.englandrugby.com)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:www.pitchero.com)",
      "WebFetch(domain:webcache.googleusercontent.com)",
      "Bash(powershell -Command:*)",
      "Bash(powershell -File:*)",
      "Bash(/tmp/inspect2.ps1 << 'PSEOF'\n$pagesDir = 'd:/TheHerd/BroadStreet/broadstreet-rfc-website/pages'\n\n# Check fan-zone for newsletter anywhere\n$fz = Get-Content \\(Join-Path $pagesDir 'fan-zone.html'\\) -Raw\nif \\($fz.Contains\\('newsletter'\\)\\) {\n    Write-Output \"fan-zone.html contains 'newsletter'\"\n} else {\n    Write-Output \"fan-zone.html does NOT contain 'newsletter'\"\n}\n\n# Check teams.html\n$t = Get-Content \\(Join-Path $pagesDir 'teams.html'\\) -Raw\n$i1 = $t.IndexOf\\('</main>'\\)\n$i2 = $t.IndexOf\\('<script'\\)\nWrite-Output \"\"\nWrite-Output \"=== teams.html \\(idx1=$i1, idx2=$i2\\) ===\"\nif \\($i1 -ge 0 -and $i2 -ge 0\\) {\n    $section = $t.Substring\\($i1, $i2 - $i1\\)\n    Write-Output \"Section length: $\\($section.Length\\)\"\n    $len = $section.Length\n    if \\($len -gt 600\\) {\n        Write-Output $section.Substring\\(0, 300\\)\n        Write-Output \"... [trimmed] ...\"\n        Write-Output $section.Substring\\($len - 300\\)\n    } else {\n        Write-Output $section\n    }\n}\n\n# Check safeguarding.html\n$sg = Get-Content \\(Join-Path $pagesDir 'safeguarding.html'\\) -Raw\n$i1 = $sg.IndexOf\\('</main>'\\)\n$i2 = $sg.IndexOf\\('<script'\\)\nWrite-Output \"\"\nWrite-Output \"=== safeguarding.html \\(idx1=$i1, idx2=$i2\\) ===\"\nif \\($i1 -ge 0 -and $i2 -ge 0\\) {\n    $section = $sg.Substring\\($i1, $i2 - $i1\\)\n    Write-Output $section\n}\nPSEOF)",
      "Bash(powershell -ExecutionPolicy Bypass -File:*)",
      "Bash(/tmp/inspect3.ps1 << 'PSEOF'\n$pagesDir = 'd:/TheHerd/BroadStreet/broadstreet-rfc-website/pages'\n\n# Check fan-zone.html for newsletter context\n$fz = Get-Content \\(Join-Path $pagesDir 'fan-zone.html'\\) -Raw\n$nlIdx = $fz.IndexOf\\('newsletter'\\)\nWrite-Output \"fan-zone.html: 'newsletter' found at index $nlIdx\"\nWrite-Output $fz.Substring\\([Math]::Max\\(0, $nlIdx - 50\\), 200\\)\nWrite-Output \"\"\n\n# Check safeguarding - does it have back-to-top?\n$sg = Get-Content \\(Join-Path $pagesDir 'safeguarding.html'\\) -Raw\nif \\($sg.Contains\\('back-to-top'\\)\\) {\n    Write-Output \"safeguarding.html: HAS back-to-top\"\n} else {\n    Write-Output \"safeguarding.html: NO back-to-top\"\n}\n\n# Check all pages for back-to-top and newsletter presence\n$allFiles = Get-ChildItem $pagesDir -Filter '*.html'\nforeach \\($file in $allFiles\\) {\n    $c = Get-Content $file.FullName -Raw\n    $hasBackToTop = $c.Contains\\('back-to-top'\\)\n    $hasNewsletter = $c.Contains\\('footer-newsletter'\\)\n    $hasMain = $c.Contains\\('</main>'\\)\n    Write-Output \"$\\($file.Name\\): main=$hasMain, back-to-top=$hasBackToTop, newsletter=$hasNewsletter\"\n}\nPSEOF)",
      "Bash(/tmp/update_footers.ps1:*)",
      "Bash(/tmp/write_footer.ps1:*)",
      "Bash(/tmp/process_pages.ps1 << 'ENDOFFILE'\n$pagesDir = 'd:/TheHerd/BroadStreet/broadstreet-rfc-website/pages'\n$footerTemplate = [System.IO.File]::ReadAllText\\('d:/TheHerd/BroadStreet/broadstreet-rfc-website/temp_footer.html'\\)\n\n# Files to skip\n$skipFiles = @\\('admin.html'\\)\n\n$allFiles = Get-ChildItem $pagesDir -Filter '*.html'\n$modified = @\\(\\)\n$skipped = @\\(\\)\n$failed = @\\(\\)\n\nforeach \\($file in $allFiles\\) {\n    $fileName = $file.Name\n    \n    if \\($skipFiles -contains $fileName\\) {\n        $skipped += \"$fileName \\(excluded\\)\"\n        Write-Output \"SKIPPED: $fileName \\(excluded\\)\"\n        continue\n    }\n    \n    $content = [System.IO.File]::ReadAllText\\($file.FullName\\)\n    \n    # Find </main> position\n    $mainCloseIdx = $content.IndexOf\\('</main>'\\)\n    if \\($mainCloseIdx -lt 0\\) {\n        $failed += \"$fileName \\(no </main> found\\)\"\n        Write-Output \"FAILED: $fileName - no </main> found\"\n        continue\n    }\n    \n    # Find first <script position after </main>\n    $scriptIdx = $content.IndexOf\\('<script', $mainCloseIdx\\)\n    if \\($scriptIdx -lt 0\\) {\n        # Try </body> or </html> as fallback\n        $scriptIdx = $content.IndexOf\\('</body>', $mainCloseIdx\\)\n        if \\($scriptIdx -lt 0\\) {\n            $failed += \"$fileName \\(no <script or </body> found after </main>\\)\"\n            Write-Output \"FAILED: $fileName - no <script or </body> after </main>\"\n            continue\n        }\n    }\n    \n    # Build new content: everything before </main> + footer template + everything from <script onwards\n    $beforeSection = $content.Substring\\(0, $mainCloseIdx\\)\n    $afterSection = $content.Substring\\($scriptIdx\\)\n    \n    $newContent = $beforeSection + $footerTemplate + $afterSection\n    \n    # Write back with UTF-8 without BOM\n    $utf8NoBom = New-Object System.Text.UTF8Encoding $false\n    [System.IO.File]::WriteAllText\\($file.FullName, $newContent, $utf8NoBom\\)\n    \n    $modified += $fileName\n    Write-Output \"MODIFIED: $fileName \\(before=$mainCloseIdx, after=$scriptIdx\\)\"\n}\n\nWrite-Output \"\"\nWrite-Output \"=== SUMMARY ===\"\nWrite-Output \"Modified \\($\\($modified.Count\\)\\): $\\($modified -join ', '\\)\"\nWrite-Output \"Skipped \\($\\($skipped.Count\\)\\): $\\($skipped -join ', '\\)\"\nWrite-Output \"Failed \\($\\($failed.Count\\)\\): $\\($failed -join ', '\\)\"\nENDOFFILE)",
      "Bash(/tmp/verify_footers.ps1:*)",
      "Bash(/tmp/check_amp.ps1 << 'ENDOFFILE'\n$path = 'd:/TheHerd/BroadStreet/broadstreet-rfc-website/pages/about.html'\n$content = [System.IO.File]::ReadAllText\\($path\\)\n$idx = $content.IndexOf\\('Fixtures'\\)\nif \\($idx -ge 0\\) {\n    Write-Output $content.Substring\\($idx, 30\\)\n}\n\n# Also check the user wanted & not &amp;\n$idx2 = $content.IndexOf\\('Fixtures &amp; Results'\\)\n$idx3 = $content.IndexOf\\('Fixtures & Results'\\)\nWrite-Output \"Has 'Fixtures &amp; Results': $\\($idx2 -ge 0\\)\"\nWrite-Output \"Has 'Fixtures & Results': $\\($idx3 -ge 0\\)\"\nENDOFFILE)",
      "Bash(/tmp/final_check.ps1 << 'ENDOFFILE'\n$pagesDir = 'd:/TheHerd/BroadStreet/broadstreet-rfc-website/pages'\n\n# Check about.html - should have newsletter + footer + back-to-top\n$about = [System.IO.File]::ReadAllText\\(\\(Join-Path $pagesDir 'about.html'\\)\\)\n$i1 = $about.IndexOf\\('</main>'\\)\n$i2 = $about.IndexOf\\('<script', $i1\\)\n$section = $about.Substring\\($i1, $i2 - $i1\\)\nWrite-Output \"=== about.html footer section \\(first 400 chars\\) ===\"\nWrite-Output $section.Substring\\(0, [Math]::Min\\(400, $section.Length\\)\\)\nWrite-Output \"\"\nWrite-Output \"=== about.html footer section \\(last 300 chars\\) ===\"\nWrite-Output $section.Substring\\([Math]::Max\\(0, $section.Length - 300\\)\\)\n\nWrite-Output \"\"\nWrite-Output \"========================================\"\nWrite-Output \"\"\n\n# Check news.html - should NOT have duplicate newsletter\n$news = [System.IO.File]::ReadAllText\\(\\(Join-Path $pagesDir 'news.html'\\)\\)\n$i1 = $news.IndexOf\\('</main>'\\)\n$i2 = $news.IndexOf\\('<script', $i1\\)\n$section = $news.Substring\\($i1, $i2 - $i1\\)\nWrite-Output \"=== news.html footer section \\(first 400 chars\\) ===\"\nWrite-Output $section.Substring\\(0, [Math]::Min\\(400, $section.Length\\)\\)\n\n# Count newsletter sections\n$nlSectionCount = \\([regex]::Matches\\($section, '<section class=\"footer-newsletter\">'\\)\\).Count\nWrite-Output \"\"\nWrite-Output \"Newsletter <section> count in news.html footer area: $nlSectionCount\"\n\nWrite-Output \"\"\nWrite-Output \"========================================\"\nWrite-Output \"\"\n\n# Check privacy.html - was minimal, should now be full\n$priv = [System.IO.File]::ReadAllText\\(\\(Join-Path $pagesDir 'privacy.html'\\)\\)\n$i1 = $priv.IndexOf\\('</main>'\\)\n$i2 = $priv.IndexOf\\('<script', $i1\\)\n$section = $priv.Substring\\($i1, $i2 - $i1\\)\nWrite-Output \"=== privacy.html footer section length: $\\($section.Length\\) ===\"\nWrite-Output \"Has social: $\\($section.Contains\\('footer-social'\\)\\)\"\nWrite-Output \"Has contact items: $\\($section.Contains\\('footer-contact-item'\\)\\)\"\nWrite-Output \"Has newsletter: $\\($section.Contains\\('footer-newsletter'\\)\\)\"\nENDOFFILE)",
      "Bash(/tmp/verify_all.ps1 << 'ENDOFFILE'\n$pagesDir = 'd:/TheHerd/BroadStreet/broadstreet-rfc-website/pages'\n$allFiles = Get-ChildItem $pagesDir -Filter '*.html'\n\nWrite-Output \"FILE                     | NEWSLETTER | SOCIAL | CONTACT | BACK-TOP | TERMS | FOOTER-COUNT\"\nWrite-Output \"-------------------------|------------|--------|---------|----------|-------|-------------\"\n\nforeach \\($file in $allFiles\\) {\n    $content = [System.IO.File]::ReadAllText\\($file.FullName\\)\n    \n    $nl = \\([regex]::Matches\\($content, '<section class=\"footer-newsletter\">'\\)\\).Count\n    $social = $content.Contains\\('footer-social'\\)\n    $contact = $content.Contains\\('footer-contact-item'\\)\n    $btt = $content.Contains\\('class=\"back-to-top\"'\\)\n    $terms = $content.Contains\\('Terms of Use'\\)\n    $fc = \\([regex]::Matches\\($content, 'class=\"main-footer\"'\\)\\).Count\n    \n    $name = $file.Name.PadRight\\(24\\)\n    $nlStr = \"$nl\".PadRight\\(10\\)\n    $socStr = \"$social\".PadRight\\(6\\)\n    $conStr = \"$contact\".PadRight\\(7\\)\n    $bttStr = \"$btt\".PadRight\\(8\\)\n    $tStr = \"$terms\".PadRight\\(5\\)\n    \n    Write-Output \"$name | $nlStr | $socStr | $conStr | $bttStr | $tStr | $fc\"\n}\nENDOFFILE)",
      "WebFetch(domain:ics.ecal.com)",
      "WebFetch(domain:www.broadstreetrfc.co.uk)",
      "WebFetch(domain:broadstreetrfc.rfu.club)",
      "WebFetch(domain:gms.rfu.com)"
    ]
  }
}
